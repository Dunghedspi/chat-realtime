(this["webpackJsonpclient-chat"]=this["webpackJsonpclient-chat"]||[]).push([[0],{123:function(e,n,t){},124:function(e,n,t){},125:function(e,n,t){},126:function(e,n,t){},127:function(e,n,t){},128:function(e,n,t){},130:function(e,n,t){},131:function(e,n,t){},133:function(e,n,t){},159:function(e,n){},162:function(e,n,t){},163:function(e,n,t){},165:function(e,n,t){"use strict";t.r(n);var r=t(1),a=t.n(r),c=t(23),s=t.n(c),i=(t(95),t(7)),o=t(2),u=t.n(o),l=t(4),d=t(6),f=(t(97),t(77)),m=t.n(f),p=t(38),j=t.n(p),b=function(){var e=m.a.create({headers:{"X-Requested-With":"XMLHttpRequest","Access-Control-Allow-Origin":"http://34.232.126.240:3002"},baseURL:"http://34.232.126.240",withCredentials:!0});return e.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),{callApi:function(){var n=Object(l.a)(u.a.mark((function n(t,r,a,c){var s;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.defaults.headers["Content-Type"]="application/json",n.prev=1,n.next=4,e({method:t,url:r,data:JSON.stringify(a),params:j.a.stringify(c)||null});case 4:return s=n.sent,n.abrupt("return",s);case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t,r,a){return n.apply(this,arguments)}}(),setAuthorization:function(n){e.defaults.headers.Authorization="bearer ".concat(n)},sendImage:function(){var n=Object(l.a)(u.a.mark((function n(t,r,a){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.defaults.headers["Content-Type"]="multipart/form-data",n.prev=1,n.next=4,e({method:t,url:r,data:a});case 4:return c=n.sent,n.abrupt("return",c);case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t,r){return n.apply(this,arguments)}}(),dowloadImage:function(){var n=Object(l.a)(u.a.mark((function n(t,r,a){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(c=e).defaults.responseType="stream",c.defaults.headers["Content-Type"]="application/octet-stream",n.next=5,c({method:t,url:r});case 5:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()}}(),h={SignUp:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,b.callApi("POST","/users",n);case 3:return(r=e.sent)&&201===r.status&&(t=!0),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),SignIn:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.callApi("POST","/auth/signin",n);case 2:return t=e.sent,r="",t&&200===t.status&&(a=t.data.asset_token,b.setAuthorization(a),r=t.data.user),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ForgotPassword:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,b.callApi("PUT","/users/forgotpass",n);case 3:return(r=e.sent)&&200===r.status&&(t=!0),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},v=t(16),O=t(8),x="SET_INFO",g="RESET_INFO",y="CHANGE_AVATAR",w=t(21);w.a.configure();var k=function(e){w.a.success(e,{position:w.a.POSITION.BOTTOM_RIGHT,autoClose:2e3})},C=function(e){w.a.error(e,{position:w.a.POSITION.BOTTOM_RIGHT,autoClose:2e3})},S=function(e){return{type:x,payload:e}},_=t(43),N=t(0);function T(e){var n=e.option,t=e.onSubmit,r=e.methods,a=r.register,c=(r.control,r.handleSubmit);r.errors;return Object(N.jsxs)("form",{className:"account-form",onSubmit:c(t),children:[Object(N.jsxs)("div",{className:"account-form-fields "+(1===n?"sign-in":2===n?"sign-up":"forgot"),children:[Object(N.jsx)("input",{id:"email",name:"email",type:"email",placeholder:"E-mail",required:!0,ref:a}),Object(N.jsx)("input",{id:"password",name:"password",type:"password",placeholder:"Password",required:1===n||2===n,disabled:3===n,ref:3===n?null:a}),Object(N.jsx)("input",{id:"repeat-password",name:"repeatPassword",type:"password",placeholder:"Repeat password",required:2===n,disabled:1===n||3===n,ref:2===n?a:null})]}),Object(N.jsx)("button",{className:"btn-submit-form",type:"submit",children:1===n?"Sign in":2===n?"Sign up":"Reset password"})]})}var R=_.a().shape({email:_.b().email(),password:_.b().required()});function I(){var e=a.a.useState(1),n=Object(d.a)(e,2),t=n[0],r=n[1],c=Object(i.f)(),s=Object(v.a)({validationSchema:R,mode:"onBlur"}),o=Object(O.b)(),f=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=1===e.t0?3:2===e.t0?9:3===e.t0?19:24;break;case 3:return e.next=5,h.SignIn(n);case 5:return a=e.sent,console.log(a),a?(k("Logged in successfully"),o(S(a)),c("/")):C("Email or password is incorrect"),e.abrupt("break",25);case 9:if(console.log(n),n.password!==n.repeatPassword){e.next=17;break}return e.next=13,h.SignUp(n);case 13:e.sent?(k("Create Account Success"),s="Please login again",w.a.info(s,{position:w.a.POSITION.BOTTOM_RIGHT,autoClose:2e3}),r(1)):C("Email is already in use!"),e.next=18;break;case 17:C("Passwords do not match");case 18:return e.abrupt("break",25);case 19:return e.next=21,h.ForgotPassword(n);case 21:return e.sent?(k("password reset was successful"),k("check your email inbox")):C("Account does not exist!"),e.abrupt("break",25);case 24:return e.abrupt("break",25);case 25:case"end":return e.stop()}var s}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(N.jsx)("div",{className:"auth-box",children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)("header",{children:Object(N.jsxs)("div",{className:"header-headings "+(1===t?"sign-in":2===t?"sign-up":"forgot"),children:[Object(N.jsx)("span",{children:"Sign in to your account"}),Object(N.jsx)("span",{children:"Create an account"}),Object(N.jsx)("span",{children:"Reset your password"})]})}),Object(N.jsxs)("ul",{className:"options",children:[Object(N.jsx)("li",{className:1===t?"active":"",onClick:function(){return r(1)},children:"Sign in"}),Object(N.jsx)("li",{className:2===t?"active":"",onClick:function(){return r(2)},children:"Sign up"}),Object(N.jsx)("li",{className:3===t?"active":"",onClick:function(){return r(3)},children:"Forgot"})]}),Object(N.jsx)(T,{option:t,onSubmit:f,methods:s}),Object(N.jsx)("footer",{children:Object(N.jsx)("a",{href:"https://facebook.com/dunghedspi",target:"_blank",children:"Dunghedspi"})})]})})}var E=t(5),A=(t(123),{changeAvatar:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.next=3,b.sendImage("PUT","/users/upload/avatar",n);case 3:return(r=e.sent)&&200===r.status&&(t=r.data.avatar),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),changePassword:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,e.next=3,b.callApi("PUT","/users/changePassword",n);case 3:return(r=e.sent)&&200===r.status&&(t=!0),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),searchUserByEmail:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,b.callApi("GET","/users/get-user-list/"+n.email);case 3:return(r=e.sent)&&200===r.status&&(t=r.data),console.log(t),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),getUserInfo:function(){var e=Object(l.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,b.callApi("GET","/users");case 3:return(t=e.sent)&&200===t.status&&(n=t.data),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});function F(e){var n=a.a.useState([]),t=Object(d.a)(n,2),r=t[0],c=t[1],s=Object(O.c)((function(e){return e.UserReducer})),i=e.socket,o=function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.target.value,e.next=3,A.searchUserByEmail({email:t});case 3:r=e.sent,c(r);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(N.jsxs)("div",{className:"conversation-search",children:[Object(N.jsx)("input",{type:"search",className:"conversation-search-input",placeholder:"Search Messages",onChange:function(e){return o(e)}}),r.length>0?Object(N.jsx)("div",{className:"user-search-box",children:r.map((function(e,n){return Object(N.jsxs)("div",{onClick:function(){return function(e){var n=r[e];c([]);var t={name:"",token:[s.id,n.id],user_id:n.id};i.createRoom(t)}(n)},className:"user-box",children:[Object(N.jsx)("img",{className:"conversation-photo",src:e.avatar,alt:"conversation"}),Object(N.jsx)("h1",{className:"user-email",children:e.email})]},n)}))}):""]})}var M=t(83),U={GetListRoom:function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,b.callApi("GET","/message/".concat(n));case 3:return(r=e.sent)&&200===r.status&&(t=r.data),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),dowloadFileImage:function(e){b.dowloadImage("GET","/file/dowload/".concat(e))}},P=(function(){var e=Object(l.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,b.callApi("GET","/user-room/".concat(n));case 3:return(r=e.sent)&&200===r.status&&(t=r.data),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))}(),"GET_LIST_ROOM"),L="CHANGE_ACTIVE_ROOM",B="CHANGE_TOP_ROOM",D="SET_MESSAGE",G="MOVE_TOP_ROOM",q="UPDATE_TYPING_ACTIVE_ROOM",z="UPDATE_STATUS_USER",V="UPDATE_READ_MESSAGE",H=function(e){return{type:P,payload:e}},W=function(e){return{type:L,payload:e}},J=function(e){return{type:B,payload:e}},K=function(e){return function(){var n=Object(l.a)(u.a.mark((function n(t){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U.GetListRoom(e);case 2:r=n.sent,t({type:D,payload:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},X=function(e){return{type:G,payload:e}},Q=function(e){return{type:q,payload:e}},Y=function(e){return{type:z,payload:e}},$=function(e){return{type:V,payload:e}};t(124);function Z(e){Object(r.useEffect)((function(){Object(M.a)(".conversation-snippet",50)}));var n=Object(O.b)(),t=e.room,a=t.users,c=(t.name,t.messages),s=t.id,i=(null===c||void 0===c||c.users,Object(O.c)((function(e){return e.UserReducer}))),o=Object(O.c)((function(e){return e.RoomReducer})).roomActive,u=function(e,n){var t=e.findIndex((function(e){return e.id!==n}));return e[t]}(a,i.id);return Object(N.jsxs)("div",{className:"conversation-list-item ".concat(o.id===s?"active-1":""),onClick:function(){n(W(e.room))},children:[Object(N.jsx)("img",{className:"conversation-photo ".concat((null===u||void 0===u?void 0:u.online)?"border-online":""),src:u.avatar,alt:"conversation"}),(null===u||void 0===u?void 0:u.online)?Object(N.jsx)("img",{src:"./onlineIcon.png",className:"onlineIcon"}):"",Object(N.jsxs)("div",{className:"conversation-info",children:[Object(N.jsx)("h1",{className:"conversation-title",children:u.email}),function(e){var n=e.length>0?e[e.length-1]:"",t="";t="image"===(null===n||void 0===n?void 0:n.type)?"Image":null===n||void 0===n?void 0:n.message;return Object(N.jsx)("div",{className:"message_box_room",children:function(){var e,r=null===n||void 0===n||null===(e=n.users)||void 0===e?void 0:e.length;if(0===r&&(null===n||void 0===n?void 0:n.user_id)===i.id)return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{className:"conversation-snippet no_read",children:t}),Object(N.jsx)("i",{className:"ion-ios-checkmark-circle-outline"})]});if(0===r)return Object(N.jsx)("p",{className:"conversation-snippet no_read",children:t});if(r){var a=null===n||void 0===n?void 0:n.users[0];return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{className:"conversation-snippet",children:t}),(null===a||void 0===a?void 0:a.id)!==(null===i||void 0===i?void 0:i.id)?Object(N.jsx)("img",{src:null===i||void 0===i?void 0:i.avatar,className:"avatar_user_read"}):""]})}}()})}(c)]})]})}t(125);function ee(e){var n=e.title,t=e.leftItems,r=e.rightItems;return Object(N.jsxs)("div",{className:"toolbar",children:[Object(N.jsx)("div",{className:"left-items",children:t}),Object(N.jsx)("h1",{className:"toolbar-title",children:n}),Object(N.jsx)("div",{className:"right-items",children:r})]})}t(126);function ne(e){var n=e.icon,t=e.onClick;return Object(N.jsx)("i",{className:"toolbar-button ".concat(n),onClick:t})}t(127);var te=function(e){return function(){var n=Object(l.a)(u.a.mark((function n(t){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,A.changeAvatar(e);case 2:(r=n.sent)?(k("Successful avatar update"),t({type:y,payload:r})):C("UnSuccessful avatar update");case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},re=function(e){return Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,A.changePassword(e);case 2:n.sent?k("Successful UserInfo update"):C("UnSuccessful UserInfo update");case 4:case"end":return n.stop()}}),n)})))},ae=function(e,n,t){return function(){var e=Object(l.a)(u.a.mark((function e(r){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getUserInfo();case 2:(a=e.sent)?(r({type:x,payload:a}),t(a.id)):n();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()};function ce(e){var n=Object(O.c)((function(e){return e.RoomReducer})).rooms,t=Object(O.c)((function(e){return e.UserReducer})),r=a.a.useState(!1),c=Object(d.a)(r,2),s=c[0],i=c[1],o=a.a.useState(!1),u=Object(d.a)(o,2),l=u[0],f=u[1],m=Object(v.a)(),p=Object(v.a)(),j=Object(O.b)(),b=m.handleSubmit,h=m.register,x=p.handleSubmit,g=p.register,y=function(){i(!0)};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"conversation-list",children:[Object(N.jsx)(ee,{title:"Messenger",leftItems:[Object(N.jsx)(ne,{icon:"ion-ios-cog",onClick:y},"cog")],rightItems:[Object(N.jsx)(ne,{icon:"ion-ios-cog",onClick:y},"cog")]}),Object(N.jsx)(F,Object(E.a)({},e)),n.map((function(e,n){return Object(N.jsx)(Z,{room:e},n)}))]}),s?Object(N.jsxs)("div",{className:"Modal-Background",children:[Object(N.jsx)("span",{className:"close",onClick:function(){return i(!1)},children:"\xd7"}),Object(N.jsxs)("div",{class:"Center-Content",children:[Object(N.jsxs)("form",{className:"form-avatar",name:"form-avatar",children:[Object(N.jsx)("label",{htmlFor:"avatar",children:Object(N.jsx)("img",{src:t.avatar,className:"avatar-user"})}),Object(N.jsx)("input",{type:"file",name:"avatar",ref:g,hidden:!0,id:"avatar",onChange:x((function(e){var n=new FormData;n.append("avatar",e.avatar[0]),j(te(n))}))})]}),Object(N.jsxs)("form",{className:"info",onSubmit:b((function(e){j(re(e))})),name:"form-info",children:[Object(N.jsxs)("div",{className:"input-group",children:[Object(N.jsx)("label",{htmlFor:"email-user",children:"Email"}),Object(N.jsx)("input",{disabled:!0,value:t.email,id:"email-user"})]}),l?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"input-group",children:[Object(N.jsx)("label",{htmlFor:"password",children:"Password"}),Object(N.jsx)("input",{id:"password",name:"password",type:"password",autoFocus:!0,ref:h})]}),Object(N.jsxs)("div",{className:"input-group",children:[Object(N.jsx)("label",{htmlFor:"new-password",children:"New Password"}),Object(N.jsx)("input",{id:"new-password",name:"newPassword",type:"password",ref:h})]})]}):"",l?Object(N.jsx)("div",{className:"button-group",children:Object(N.jsx)("button",{type:"submit",children:"Submit"})}):Object(N.jsx)("button",{className:"change-pass",type:"button",onClick:function(){return f(!0)},children:"Change Password"})]})]})]}):""]})}var se=t(41),ie=(t(128),t(52)),oe=t.n(ie);function ue(e){var n=e.sendMessage,t=e.sendTyping,r=e.endTyping,c=Object(v.a)(),s=c.handleSubmit,i=c.register,o=a.a.useState(!1),u=Object(d.a)(o,2),l=u[0],f=u[1],m=Object(O.c)((function(e){return e.RoomReducer})).roomActive;a.a.useEffect((function(){document.getElementById("message_input").value="",f((function(){return!1}))}),[m]);return Object(N.jsxs)("div",{className:"compose",children:[e.leftItem,Object(N.jsxs)("form",{onSubmit:s((function(e,t){console.log(e),n(e,(function(){document.getElementById("message_input").blur()})),t.target.reset()})),children:[Object(N.jsx)("input",{type:"text",className:"compose-input",placeholder:"Type a message, @name",name:"message",ref:i,onChange:function(e){return t(e)},autoComplete:"off",onBlur:r,onFocus:function(){return f(!1)},id:"message_input"}),Object(N.jsxs)("div",{className:"emoji-box",children:[Object(N.jsx)("i",{className:"ion-md-happy emoji_icon",onClick:function(){return f(!l)}}),Object(N.jsx)("div",{className:"emoji-picker",children:l?Object(N.jsx)(oe.a,{onEmojiClick:function(e,n){console.log(n),document.getElementById("message_input").value+=n.emoji},disableAutoFocus:!0,groupNames:{smileys_people:"PEOPLE"},skinTone:ie.SKIN_TONE_MEDIUM_DARK,className:"emoji-picker",disableSearchBar:!0}):""})]})]}),e.rightItems]})}var le=t(20),de=t.n(le),fe=(t(130),"http://34.232.126.240/uploads/image/"),me=function(e,n,t,r){return"image"===e?Object(N.jsx)("img",{src:"".concat(fe).concat(n),className:"imageChat",onClick:function(){return r("".concat(fe).concat(n))}}):Object(N.jsx)("div",{className:"bubble",title:t,children:n})};function pe(e){var n,t=e.data,r=e.isMine,a=e.startsSequence,c=e.endsSequence,s=e.showTimestamp,i=e.type,o=e.mine,u=e.showUser,l=e.isSend,d=de()(t.timestamp).format("LLLL");Object(O.c)((function(e){return e.UserReducer}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:["message","".concat(r?"mine":""),"".concat(a?"start":""),"".concat(c?"end":"")].join(" "),children:[s&&Object(N.jsxs)("div",{className:"timestamp",children:[" ",d," "]}),Object(N.jsxs)("div",{className:"bubble-container",children:[r?"":Object(N.jsx)("img",{src:null===o||void 0===o?void 0:o.avatar,className:"avatarmine"}),me(i,t.message,d,(function(e){return function(e){var n=document.getElementById("myModal"),t=(document.getElementById("myImg"),document.getElementById("img01"));n.style.display="block",t.src=e}(e)}))]}),Object(N.jsx)("div",{className:"user_read_list",children:(n=u,l&&r?Object(N.jsx)("i",{className:"ion-ios-checkmark-circle-outline"}):Object(N.jsx)("ul",{className:"list-user",children:n.map((function(e,n){return Object(N.jsx)("li",{children:Object(N.jsx)("img",{className:"avatar_user_read",src:e.avatar})},n)}))}))})]}),"image"===i?Object(N.jsxs)("div",{id:"myModal",className:"modal",children:[Object(N.jsx)("i",{className:"ion-md-arrow-down dowloadImage",onClick:function(){var e=document.getElementById("img01").src.split("/");U.dowloadFileImage(e[e.length-1])}}),Object(N.jsx)("span",{className:"close",id:"close",onClick:function(){document.getElementById("myModal").style.display="none"},children:"\xd7"}),Object(N.jsx)("img",{className:"modal-content",id:"img01"})]}):""]})}t(131);var je,be,he,ve,Oe,xe,ge,ye,we,ke,Ce,Se,_e=t(9),Ne=t(10),Te=(Ne.a.div(je||(je=Object(_e.a)(["\n  height: inherit;\n  display: flex;\n  align-items: center;\n  margin-bottom: -5px;\n\n  span {\n    width: 40px;\n    height: 40px;\n    display: flex;\n    overflow: hidden;\n    position: relative;\n    font-size: 2rem;\n    align-items: center;\n    flex-shrink: 0;\n    font-family: inherit;\n    line-height: 1;\n    user-select: none;\n    border-radius: 50%;\n    justify-content: center;\n  }\n\n  img {\n    color: transparent;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    text-align: center;\n    text-indent: 10000px;\n  }\n"]))),Ne.a.h1(be||(be=Object(_e.a)(["\n  color: white;\n  font-size: 1.5rem;\n  @media screen and (max-width: 936px) {\n    font-size: 1rem;\n  }\n"]))),Ne.a.button(he||(he=Object(_e.a)(["\n  border: 0;\n  background: #1da1f2;\n  font-size: 17px;\n  padding: 10px;\n  cursor: pointer;\n  border-radius: 5px;\n  color: white;\n  font-weight: bold;\n  margin-right: 10px;\n\n  &:last-child {\n    margin: 0px;\n  }\n\n  &:focus {\n    outline: none;\n  }\n\n  &:hover {\n    background: #1872a9;\n  }\n"])))),Re=Ne.a.video(ve||(ve=Object(_e.a)([""]))),Ie=function(e){var n=e.isFullScreen,t=e.onToggle;return Object(N.jsx)(Te,{onClick:function(){return t()},children:n?"Exit Full Screen":"Full Screen"})},Ee=function(e){var n=e.isSharing,t=e.onToggle;return Object(N.jsx)(Te,{onClick:function(){return t()},children:n?"Cancel":"Share Screen"})},Ae=t.p+"static/media/menu.8dc73102.svg",Fe=Object(Ne.a)(Re)(Oe||(Oe=Object(_e.a)(["\n  position: relative;\n  width: 100%;\n  background: black;\n\n  @media screen and (min-width: 936px) {\n    position: absolute;\n    border: 1px solid #38444d;\n    bottom: 60px;\n    right: 40px;\n    border-radius: 5px;\n    width: 300px;\n    height: auto;\n  }\n"]))),Me=Object(Ne.a)(Re)(xe||(xe=Object(_e.a)(["\n  background: black;\n  width: 100%;\n  min-height: 100vh;\n\n  @media screen and (max-width: 936px) {\n    box-shadow: none;\n    border-radius: 0;\n    width: 100%;\n    height: auto;\n    border: none;\n  }\n"]))),Ue=(Ne.a.div(ge||(ge=Object(_e.a)(["\n  width: 280px;\n  z-index: 1;\n  background-color: #16202c;\n  position: relative;\n  top: 64px;\n  flex: 1 0 auto;\n  height: 100%;\n  display: flex;\n  outline: 0;\n  z-index: 9;\n  position: fixed;\n  overflow-y: auto;\n  flex-direction: column;\n  border-right: 0.5pt solid #38444d;\n  \n  @media screen and (max-width: 936px) {\n    display: ",";\n    width: ",";\n  }\n}\n"])),(function(e){return e.isLeftSideShow?"block":"none"}),(function(e){return e.isLeftSideShow?"100%":"280px"})),Ne.a.div(ye||(ye=Object(_e.a)(["\n  box-sizing: content-box;\n  flex-grow: 1;\n  overflow-y: auto;\n"]))),Ne.a.div(we||(we=Object(_e.a)(["\n  padding: 10px 30px;\n  border-bottom: 1px solid #38444d;\n  cursor: pointer;\n  user-select: none;\n  color: white;\n\n  &:hover {\n    background-color: #25394c;\n    transition: background-color 0.5s ease;\n  }\n\n  ","\n"])),(function(e){return e.selected&&"\n    background-color: #25394c;\n    border-right: 5px solid #65a9e5;\n    font-weight: 500;\n    transition: all 0.5s ease;\n  "})),function(e){var n=e.onTurnOff;return Object(N.jsx)(Te,{onClick:function(){return n()},children:"TurnOff"})}),Pe=function(e){var n=e.isScreenSharing,t=e.onScreenShare,a=e.isFullScreen,c=e.onFullScreen,s=e.isTimerStarted,i=e.onTurnOff,o=Object(r.useState)(0),u=Object(d.a)(o,2),l=u[0],f=u[1];return Object(r.useEffect)((function(){var e;return s?e=setInterval((function(){return f((function(e){return e+1}))}),1e3):f(0),function(){return clearInterval(e)}}),[s]),Object(N.jsxs)("div",{style:{position:"absolute",bottom:"24px",display:"flex",justifyContent:"center",width:"100%"},children:[Object(N.jsxs)("div",{children:[Object(N.jsx)(Ee,{isSharing:n,onToggle:function(){return t(!n)}}),Object(N.jsx)(Ie,{isFullScreen:a,onToggle:function(){return c(!a)}}),Object(N.jsx)(Ue,{onTurnOff:i})]}),Object(N.jsx)("div",{}),Object(N.jsx)("span",{style:{color:"white",fontWeight:"bold",right:"40px",bottom:"12px",position:"absolute"},children:new Date(1e3*l).toISOString().substr(11,8)})]})},Le=(Ne.a.header(ke||(ke=Object(_e.a)(["\n  position: relative;\n  width: 100%;\n  display: flex;\n  background: #16202c;\n  box-shadow: 2px 2px 6px #000000;\n  box-sizing: border-box;\n  flex-shrink: 0;\n  flex-direction: column;\n  z-index: 10;\n\n  .toolbar {\n    height: 64px;\n    padding-left: 24px;\n    padding-right: 24px;\n    display: flex;\n    position: relative;\n    align-items: center;\n  }\n"]))),Ne.a.input.attrs({type:"image",src:Ae})(Ce||(Ce=Object(_e.a)(["\n  height: 40px;\n  width: 40px;\n  margin-right: 24px;\n  display: none;\n\n  &:focus {\n    outline: none;\n  }\n\n  @media screen and (max-width: 936px) {\n    display: block;\n    margin-left: 0;\n    flex-direction: column;\n  }\n"]))),Ne.a.main(Se||(Se=Object(_e.a)(["\n  margin-left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: ",";\n\n  @media screen and (max-width: 936px) {\n    margin-left: 0;\n    flex-direction: column;\n    align-items: flex-start;\n    justify-content: flex-start;\n    z-index: inherit;\n  }\n"])),(function(e){return e.full?"#16202c":"black"}))),Be=(t(133),t(87)),De=t(39),Ge=t(42),qe=window,ze=qe.RTCPeerConnection,Ve=qe.RTCSessionDescription;var He=function(){function e(n,t){var r=this;Object(Be.a)(this,e),this.socket=n,this.peerConnection=t,this.isAlreadyCalling=!1,this.peerConnection.addEventListener("connectionstatechange",(function(e){console.log(r.peerConnection.connectionState);var n,t=r["_on"+(n=r.peerConnection.connectionState,n.charAt(0).toUpperCase()+n.slice(1))];t&&t(e)})),this.onCallMade()}return Object(De.a)(e,[{key:"callUser",value:function(){var e=Object(l.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.peerConnection.createOffer();case 2:return t=e.sent,e.next=5,this.peerConnection.setLocalDescription(new Ve(t));case 5:this.socket.emit("make-offer",{offer:t,room_id:n});case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onCallMade",value:function(){var e=this;this.socket.on("call-made",function(){var n=Object(l.a)(u.a.mark((function n(t){var r,a,c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.room_id,a=t.offer,console.log("call-made",r,a),n.next=4,e.peerConnection.setRemoteDescription(new Ve(t.offer));case 4:return n.next=6,e.peerConnection.createAnswer();case 6:return c=n.sent,n.next=9,e.peerConnection.setLocalDescription(new Ve(c));case 9:e.socket.emit("make-answer",{answer:c,room_id:r});case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"onAnswerMade",value:function(e){var n=this;this.socket.on("answer-made",function(){var t=Object(l.a)(u.a.mark((function t(r){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.peerConnection.setRemoteDescription(new Ve(r.answer));case 2:console.log("answer",r.answer),n.isAlreadyCalling||(e(r.room_id),n.isAlreadyCalling=!0);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"onConnected",value:function(e){this._onConnected=e}},{key:"onDisconnected",value:function(e){this._onDisconnected=e}},{key:"onCallRejected",value:function(e){this.socket.on("call-rejected",(function(n){e(n)}))}},{key:"onTrack",value:function(e){this.peerConnection.ontrack=function(n){var t=Object(d.a)(n.streams,1)[0];e(t)}}},{key:"callUserBeforeConnect",value:function(e){this.socket.emit("call-user",{room_id:e})}},{key:"resolveCall",value:function(e){this.socket.emit("resolve-call",{room_id:e})}},{key:"onResolveCall",value:function(e){this.socket.on("resolve-call",(function(n){var t=n.room_id;e(t)}))}},{key:"onRejectCall",value:function(e){this.socket.on("reject-call",(function(n){var t=n.user;e(t)}))}},{key:"turnOffVideoCall",value:function(){this.peerConnection.close()}},{key:"onListenStateChange",value:function(e){var n=this;this.peerConnection.onconnectionstatechange=function(){switch(n.peerConnection.connectionState){case"disconnected":e()}}}}]),e}();var We,Je=[],Ke=function(){var e=j.a.parse(Object(i.d)().search,{ignoreQueryPrefix:!0}),n=Object(r.useState)(null),t=Object(d.a)(n,2),a=t[0],c=t[1],s=Object(r.useState)(!1),o=Object(d.a)(s,2),f=o[0],m=o[1],p=Object(r.useState)(null),b=Object(d.a)(p,2),h=b[0],v=b[1],O=Object(r.useState)(!1),x=Object(d.a)(O,2),g=x[0],y=x[1],w=Object(r.useState)({}),k=Object(d.a)(w,2),C=k[0],S=k[1],_=Object(r.useState)(!1),T=Object(d.a)(_,2),R=T[0],I=T[1],E=Object(r.useRef)(),A=Object(r.useRef)(),F=Object(r.useRef)();function M(){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=h,e.t0){e.next=5;break}return e.next=4,navigator.mediaDevices.getDisplayMedia();case 4:e.t0=e.sent;case 5:return n=e.t0,e.next=8,Je.find((function(e){return"video"===e.track.kind})).replaceTrack(n.getTracks()[0]);case 8:n.getVideoTracks()[0].addEventListener("ended",(function(){P(n)})),E.current.srcObject=n,v(n);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return L.apply(this,arguments)}function L(){return(L=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.find((function(e){return"video"===e.track.kind})).replaceTrack(a.getTracks().find((function(e){return"video"===e.kind})));case 2:E.current.srcObject=a,n.getTracks().forEach((function(e){return e.stop()})),v(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return(B=Object(l.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,M();case 3:e.next=7;break;case 5:return e.next=7,P(h);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){We=function(){var e=new ze({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),n=Ge("http://34.232.126.240/chat");return new He(n,e)}()}),[]),Object(r.useEffect)((function(){(function(){var e=Object(l.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=7;break}return e.next=3,navigator.mediaDevices.getUserMedia({video:{width:{min:640,ideal:1920},height:{min:400,ideal:1080},aspectRatio:{ideal:1.7777777778}},audio:!0});case 3:n=e.sent,E&&(E.current.srcObject=n),n.getTracks().forEach((function(e){Je.push(We.peerConnection.addTrack(e,n))})),c(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a]),Object(r.useEffect)((function(){We.onAnswerMade((function(e){return We.callUser(e)})),We.onCallRejected((function(e){return alert('User: "Socket: '.concat(e.socket,'" rejected your call.'))})),We.onTrack((function(e){return A.current.srcObject=e})),We.onResolveCall((function(e){We.callUser(e)})),We.onConnected((function(){m(!0)})),We.onDisconnected((function(){m(!1),A.current.srcObject=null})),We.onRejectCall((function(e){S(e),setTimeout((function(){window.close()}),2500)})),We.onListenStateChange((function(){We.turnOffVideoCall(),I(!0)}))}),[]),Object(r.useEffect)((function(){0===parseInt(localStorage.getItem("user-call"))?We.resolveCall(e.room_id):We.callUserBeforeConnect(e.room_id)}),[]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Le,{ref:F,children:R?Object(N.jsx)("div",{className:"Call_Modal",children:Object(N.jsx)("div",{className:"User_Call_Box",children:Object(N.jsx)("h1",{children:"Cu\u1ed9c g\u1ecdi \u0111\xe3 k\u1ebft th\xfac"})})}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Me,{ref:A,autoPlay:!0}),Object(N.jsx)(Fe,{ref:E,autoPlay:!0,muted:!0}),Object(N.jsx)(Pe,{isScreenSharing:Boolean(h),onScreenShare:function(e){return B.apply(this,arguments)},isFullScreen:g,onFullScreen:function(e){y(e),e?function(){y(!0);var e=F.current;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}():document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},isTimerStarted:f,onTurnOff:function(){We.turnOffVideoCall(),I(!0)}})]})}),(null===C||void 0===C?void 0:C.id)?Object(N.jsx)("div",{className:"Call_Modal",children:Object(N.jsxs)("div",{className:"User_Call_Box",children:[Object(N.jsx)("h1",{children:"T\u1eeb ch\u1ed1i cu\u1ed9c g\u1ecdi"}),Object(N.jsxs)("div",{className:"user_box",children:[Object(N.jsx)("div",{className:"avatar_box",children:Object(N.jsx)("img",{src:C.avatar})}),Object(N.jsx)("div",{className:"call-user-info",children:Object(N.jsxs)("p",{children:[Object(N.jsx)("strong",{children:C.email})," ","\u0111\xe3 t\u1eeb ch\u1ed1i g\u1ecdi cho b\u1ea1n"]})})]})]})}):""]})};function Xe(e){var n,t=e.socket,r=Object(O.c)((function(e){return e.UserReducer})),c=Object(O.c)((function(e){return e.RoomReducer})),s=c.roomActive,o=c.rooms,u=a.a.useState({}),l=Object(d.a)(u,2),f=l[0],m=l[1];a.a.useEffect((function(){var e,n=null===s||void 0===s||null===(e=s.users)||void 0===e?void 0:e.findIndex((function(e){return e.id!==r.id}));n>-1&&m(s.users[n])}),[s]);var p=Object(v.a)(),j=p.handleSubmit,b=p.register,h=(Object(i.f)(),o.findIndex((function(e){return e.id===s.id}))),x=null===(n=o[h])||void 0===n?void 0:n.messages,g=a.a.useRef();a.a.useEffect((function(){g.current.scrollIntoView({behavior:"smooth"})}));a.a.useRef(null);return Object(N.jsxs)("div",{className:"message-list",children:[Object(N.jsx)(ee,{title:"Conversation Title",rightItems:[Object(N.jsx)(ne,{icon:"ion-ios-videocam",onClick:function(){return window.open("/videocall?room_id="+s.id,"_blank","height=1200,width=1200"),void localStorage.setItem("user-call",1)}},"video")]}),Object(N.jsxs)("div",{className:"message-list-container",children:[function(){for(var e=(null===x||void 0===x?void 0:x.length)-1,n=[],a=[];e>=0;){var c,i=x[e-1],o=x[e],u=x[e+1],l=o.user_id===r.id,d=de()(o.timestamp),m=!0,p=!0,j=!0,b=null===(c=x[e])||void 0===c?void 0:c.type,h=!1;if(i){var v=de()(i.timestamp),O=de.a.duration(d.diff(v));i.author===o.author&&O.as("hours")<1&&(m=!1),O.as("hours")<1&&(j=!1)}if(u){var g=de()(u.timestamp),y=de.a.duration(g.diff(d));u.author===o.author&&y.as("hours")<1&&(p=!1)}var w=[];if(o.id){var k=o.users;0===(null===k||void 0===k?void 0:k.length)&&(!0===l?h=!0:(null===o||void 0===o?void 0:o.id)&&(console.log(o),t.sendReadMessage({id:null===o||void 0===o?void 0:o.id,room_id:s.id})));var C,S=Object(se.a)(k);try{var _=function(){var e=C.value;a.findIndex((function(n){return n===e.id}))<0&&e.id!==r.id&&(w.push(e),a.push(e.id))};for(S.s();!(C=S.n()).done;)_()}catch(T){S.e(T)}finally{S.f()}}n.unshift(Object(N.jsx)(pe,{isMine:l,startsSequence:m,endsSequence:p,showTimestamp:j,data:o,type:b,mine:f,showUser:w,isSend:h},e)),e-=1}return n}(),(null===s||void 0===s?void 0:s.isTyping)?Object(N.jsxs)("div",{className:"container-chat",children:[Object(N.jsx)("span",{className:"circle"}),Object(N.jsx)("span",{className:"circle"}),Object(N.jsx)("span",{className:"circle"})]}):"",Object(N.jsx)("div",{ref:g,className:"list-bottom"})]}),Object(N.jsx)(ue,{leftItem:[Object(N.jsx)(ne,{icon:"ion-ios-image",onClick:function(){document.getElementById("inputFile").click()}},"image")],rightItems:[Object(N.jsx)(ne,{icon:"ion-md-send"},"send")],sendMessage:function(e,n){var a={user_id:r.id,room_id:s.id,message:e.message};t.sendMess(a),n()},sendTyping:function(e){e.target.value&&t.sendTyping({room_id:s.id})},endTyping:function(){t.endTyping({room_id:s.id})}}),Object(N.jsx)("form",{children:Object(N.jsx)("input",{hidden:!0,type:"file",name:"image",id:"inputFile",ref:b,onChange:j((function(e){var n=e.image[0],a=new FileReader;a.readAsDataURL(n),a.onload=function(){var e=a.result,n={user_id:r.id,room_id:s.id,message:e};t.sendImage(n)}}))})})]})}t(162);function Qe(e){return Object(N.jsxs)("div",{className:"messenger",children:[Object(N.jsx)("div",{className:"scrollable sidebar",children:Object(N.jsx)(ce,Object(E.a)({},e))}),Object(N.jsx)("div",{className:"scrollable content",children:Object(N.jsx)(Xe,Object(E.a)({},e))})]})}var Ye="GET_LIST_MESSAGE",$e="ADD_MESSAGE",Ze="IS_CALL_TRUE",en="IS_CALL_FALSE",nn=function(e){return{type:Ze,payload:e}},tn=function(){return{type:en}};t(163);function rn(){var e=Object(O.b)(),n=Object(O.c)((function(e){return e.UserReducer})),t=Object(i.f)(),r=Object(O.c)((function(e){return e.RoomReducer})).roomActive,c=function(e){return function(n){var t=function(e,n,t){return window.onbeforeunload=function(n){e.emit("offline",{})},e.on("connect",(function(){console.log("connected ...")})),e.on("recvMess",(function(r){console.log(r),n(J({payload:r,sendReadMessage:function(n){console.log(n),e.emit("read-message",n)},userId:t}))})),e.on("recvRoom",(function(t){e.emit("joinRoom",t),n(X(t))})),e.on("call-user",(function(e){e.user.id!==t&&n(nn(e))})),e.on("typing",(function(e){var t=e.room_id;n(Q({typing:!0,room_id:t}))})),e.on("endtyping",(function(e){var t=e.room_id;n(Q({typing:!1,room_id:t}))})),e.on("online",(function(e){var t=e.user_id;n(Y({user_id:t,online:!0}))})),e.on("offline",(function(e){var t=e.user_id;n(Y({user_id:t,online:!1}))})),e.on("rooms",(function(e){n(H(e))})),e.on("read-message",(function(e){n($(e))})),{sendMess:function(n){e.emit("sendMess",n)},joinRoom:function(n){e.emit("joinRoom",n)},afterConnect:function(n){e.emit("afterConnect",n)},joinListRoom:function(n){console.log("joinListRoom"),e.emit("joinListRoom",n)},sendImage:function(n){e.emit("sendImage",n)},createRoom:function(n){e.emit("createRoom",n)},sendTyping:function(n){e.emit("typing",n)},endTyping:function(n){e.emit("endtyping",n)},sendReadMessage:function(n){e.emit("read-message",n)},rejectCall:function(n){e.emit("reject-call",n)}}}(Ge("http://34.232.126.240/chat"),e,n);m(t)}}(e);a.a.useEffect((function(){e(ae(n,(function(){return t("/auth")}),c))}),[]),a.a.useEffect((function(){(function(){var n=Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(null===r||void 0===r?void 0:r.id)&&e(K(r.id));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[r]);var s=a.a.useState(""),o=Object(d.a)(s,2),f=o[0],m=o[1],p=Object(O.c)((function(e){return e.CallReducer})),j=p.isCall,b=p.userCall,h=p.room_id;a.a.useEffect((function(){f&&f.afterConnect({user_id:n.id})}),[f]);Object(O.c)((function(e){return e.RoomReducer})).rooms;a.a.useEffect((function(){f&&f.joinListRoom({offset:0})}),[f]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(Qe,{socket:f})}),j?Object(N.jsx)("div",{className:"Call_Modal",children:Object(N.jsxs)("div",{className:"User_Call_Box",children:[Object(N.jsx)("h1",{children:"C\xf3 cu\u1ed9c g\u1ecdi t\u1edbi"}),Object(N.jsxs)("div",{className:"user_box",children:[Object(N.jsx)("div",{className:"avatar_box",children:Object(N.jsx)("img",{src:b.avatar})}),Object(N.jsxs)("div",{className:"call-user-info",children:[Object(N.jsxs)("p",{children:[Object(N.jsx)("strong",{children:b.email})," ","\u0111ang g\u1ecdi cho b\u1ea1n"]}),Object(N.jsx)("span",{children:"Cu\u1ed9c g\u1ecdi b\u1eaft \u0111\u1ea7u khi b\u1ea1n nh\u1ea5n ch\u1ea5p nh\u1eadn"}),Object(N.jsxs)("div",{className:"group_button",children:[Object(N.jsx)("button",{onClick:function(){return function(n){f.rejectCall({room_id:n}),e(tn())}(h)},children:"T\u1eeb Ch\u1ed1i"}),Object(N.jsx)("button",{onClick:function(){return function(n){window.open("/videocall?room_id="+n,"_blank","height=1200,width=1200"),e(tn()),localStorage.setItem("user-call",0)}(h)},children:"Ch\u1ea5p Nh\u1eadn"})]})]})]})]})}):""]})}var an=[{path:"/",element:Object(N.jsx)(rn,{})},{path:"/auth/*",element:Object(N.jsx)(I,{})},{path:"/videocall/*",element:Object(N.jsx)(Ke,{})}];t(164);function cn(){var e=Object(i.h)(an);return Object(N.jsx)("div",{className:"App",children:e})}var sn=t(90);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var on=t(22),un=t(18),ln=t(13),dn={rooms:[],roomActive:{}},fn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case P:return Object(E.a)(Object(E.a)({},e),{},{rooms:n.payload,roomActive:n.payload.length>0?n.payload[0]:{}});case L:return Object(E.a)(Object(E.a)({},e),{},{roomActive:n.payload});case B:var t=e.rooms,r=e.roomActive,a=n.payload,c=a.payload,s=a.sendReadMessage,i=a.userId;c.room_id===r.id&&c.user_id!==i&&s(c);var o=t.findIndex((function(e){return e.id===c.room_id}));return o>-1&&(t[o].messages.push(c),t.unshift.apply(t,Object(ln.a)(t.splice(o,1)))),Object(E.a)(Object(E.a)({},e),{},{rooms:t,roomActive:r});case D:var u=e.rooms,l=e.roomActive,d=u.findIndex((function(e){return e.id===l.id}));return d>-1&&(u[d].messages=n.payload,l.messages=n.payload),Object(E.a)(Object(E.a)({},e),{},{rooms:u,roomActive:l});case G:var f=e.rooms;return f.unshift(n.payload),Object(E.a)(Object(E.a)({},e),{},{rooms:f});case q:var m,p=e.roomActive,j=n.payload.room_id;if(j===p.id)p.isTyping=null===(m=n.payload)||void 0===m?void 0:m.typing;return Object(E.a)(Object(E.a)({},e),{},{roomActive:p});case z:var b=function(){var t,r=n.payload,a=r.user_id,c=r.online,s=e.rooms,i=[],o=Object(se.a)(s);try{for(o.s();!(t=o.n()).done;){var u=t.value,l=u.users,d=l.findIndex((function(e){return e.id===a}));d>-1&&(l[d].online=c),i.push(u)}}catch(f){o.e(f)}finally{o.f()}return{v:Object(E.a)(Object(E.a)({},e),{},{rooms:i})}}();if("object"===typeof b)return b.v;case V:var h=e.rooms,v=n.payload,O=v.message_id,x=v.room_id,g=v.user,y=h.findIndex((function(e){return e.id===x}));if(y>-1){var w=h[y].messages,k=w.findIndex((function(e){return e.id===O}));k>-1&&(console.log(w[k]),w[k].users=[],w[k].users.push(g))}return Object(E.a)(Object(E.a)({},e),{},{rooms:h});default:return Object(E.a)({},e)}},mn={email:"",avatar:"",isLogin:!1},pn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case x:return Object(E.a)(Object(E.a)(Object(E.a)({},e),n.payload),{},{isLogin:!0});case g:return Object(E.a)({},mn);case y:return Object(E.a)(Object(E.a)({},e),{},{avatar:n.payload});default:return Object(E.a)({},e)}},jn={messages:[]},bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case Ye:return Object(E.a)(Object(E.a)({},e),{},{messages:n.payload});case $e:var t=e.messages;return t.push(n.payload),Object(E.a)(Object(E.a)({},e),{},{messages:t});default:return Object(E.a)({},e)}},hn={isCall:!1,userCall:"",room_id:-1},vn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hn,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case Ze:var t=n.payload;return Object(E.a)(Object(E.a)({},e),{},{isCall:!0,userCall:t.user,room_id:t.room_id});case en:return Object(E.a)({},hn);default:return Object(E.a)({},e)}},On=Object(un.combineReducers)({RoomReducer:fn,UserReducer:pn,MessageListReducer:bn,CallReducer:vn}),xn=t(88),gn=t(89),yn=Object(un.createStore)(On,Object(xn.composeWithDevTools)(Object(un.applyMiddleware)(gn.a))),wn=Object(sn.a)();s.a.render(Object(N.jsx)(O.a,{store:yn,children:Object(N.jsx)(on.a,{history:wn,children:Object(N.jsx)(cn,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},95:function(e,n,t){},97:function(e,n,t){}},[[165,1,2]]]);
//# sourceMappingURL=main.05e26138.chunk.js.map